;; DO NOT EDIT THIS FILE!!
;; This inlined chez-srfi library code is autogenerated using command:
;; $ ./install.chezscheme.sps ../vendor
;; Source origin: https://github.com/arcfide/chez-srfi
;; Please refer to project site for full credits and original code.
;;;;;; File header: %3a5/let.sls
;; Copyright © 2020 Göran Weinholt
;; SPDX-License-Identifier: MIT
#!r6rs
(library (srfi :5 let)
  (export let)
  (import (rename (rnrs) (let rnrs:let)))
  (define-syntax let
    (lambda (x)
      (define (let-args x)
        (syntax-case x ()
          [(_ ((lhs rhs) . x*) (lhs* ...) (rhs* ...))
           (identifier? #'lhs)
           (let-args #'(_ x* (lhs* ... lhs) (rhs* ... rhs)))]
          [(_ (rest arg* ...) (lhs* ...) (rhs* ...))
           (identifier? #'rest)
           #'((lhs* ... . rest) (rhs* ... arg* ...))]
          [(_ () lhs* rhs*) #'(lhs* rhs*)]))
      (syntax-case x ()
        [(_ name bindings body ...)
         (identifier? #'name)
         (with-syntax ([(lhs* rhs*) (let-args
                                      #'(let-args bindings () ()))])
           #'((letrec ([name (lambda lhs* body ...)]) name) . rhs*))]
        [(_ (name . bindings) body ...)
         (identifier? #'name)
         #'(let name bindings body ...)]
        [(_ bindings body ...)
         (with-syntax ([(lhs* rhs*) (let-args
                                      #'(let-args bindings () ()))])
           #'((lambda lhs* body ...) . rhs*))]))))
