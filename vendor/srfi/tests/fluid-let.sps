;; DO NOT EDIT THIS FILE!!
;; This inlined chez-srfi library code is autogenerated using command:
;; $ ./install.chezscheme.sps ../vendor
;; Source origin: https://github.com/arcfide/chez-srfi
;; Please refer to project site for full credits and original code.
;;;;;; File header: ./tests/fluid-let.sps
;; Copyright 2000 Lars T Hansen
;; SPDX-License-Identifier: MIT
(import (rnrs) (srfi :15 fluid-let) (srfi :64 testing))
(test-begin "fluid-let")
(let ([results '()])
  (define (display x)
    (set! results (append results (list x))))
  (define v 1)
  (define again #f)
  (define (test1)
    (display v)
    (fluid-let ([v 2])
      (call-with-current-continuation
        (lambda (k)
          (set! again (lambda () (set! again #f) (k #t)))))
      (test2)
      (set! v 3))
    (display v)
    (set! v 4)
    (if again (again)))
  (define (test2) (display v))
  (test1)
  (test-equal '(1 2 1 3 4) results))
(test-end)
